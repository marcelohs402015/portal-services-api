# PostgreSQL Database Dockerfile for Render
FROM postgres:17-alpine

# Set environment variables
ENV POSTGRES_USER=admin
ENV POSTGRES_DB=portalservicesdb
ENV POSTGRES_INITDB_ARGS="--encoding=UTF-8 --lc-collate=C --lc-ctype=C"

# Copy initialization scripts
COPY appserver/database/init/ /docker-entrypoint-initdb.d/

# Expose port
EXPOSE 5432

# Health check
HEALTHCHECK --interval=30s --timeout=10s --start-period=30s --retries=3 \
  CMD pg_isready -U admin -d portalservicesdb

# Start PostgreSQL
CMD ["postgres"]
