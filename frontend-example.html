<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Portal Services API - Exemplo Frontend</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 1200px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            margin-bottom: 20px;
        }
        .api-info {
            background: #e3f2fd;
            border-left: 4px solid #2196f3;
        }
        .endpoint {
            background: #f3e5f5;
            border-left: 4px solid #9c27b0;
        }
        .data-display {
            background: #e8f5e8;
            border-left: 4px solid #4caf50;
        }
        button {
            background: #2196f3;
            color: white;
            border: none;
            padding: 10px 20px;
            border-radius: 4px;
            cursor: pointer;
            margin: 5px;
        }
        button:hover {
            background: #1976d2;
        }
        pre {
            background: #f5f5f5;
            padding: 15px;
            border-radius: 4px;
            overflow-x: auto;
            white-space: pre-wrap;
        }
        .error {
            color: #f44336;
            background: #ffebee;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .success {
            color: #4caf50;
            background: #e8f5e8;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
        .loading {
            color: #ff9800;
            background: #fff3e0;
            padding: 10px;
            border-radius: 4px;
            margin: 10px 0;
        }
    </style>
</head>
<body>
    <h1>üöÄ Portal Services API - Exemplo Frontend</h1>
    
    <div class="container api-info">
        <h2>üìã Informa√ß√µes da API</h2>
        <button onclick="getApiInfo()">Obter Informa√ß√µes da API</button>
        <button onclick="checkApiHealth()">Verificar Sa√∫de da API</button>
        <div id="api-info-result"></div>
    </div>

    <div class="container endpoint">
        <h2>üìä Estat√≠sticas</h2>
        <button onclick="getBusinessStats()">Estat√≠sticas do Neg√≥cio</button>
        <button onclick="getDashboardStats()">Estat√≠sticas do Dashboard</button>
        <div id="stats-result"></div>
    </div>

    <div class="container endpoint">
        <h2>üìã Categorias</h2>
        <button onclick="getCategories()">Listar Categorias</button>
        <button onclick="createSampleCategory()">Criar Categoria de Exemplo</button>
        <div id="categories-result"></div>
    </div>

    <div class="container endpoint">
        <h2>üë• Clientes</h2>
        <button onclick="getClients()">Listar Clientes</button>
        <button onclick="createSampleClient()">Criar Cliente de Exemplo</button>
        <div id="clients-result"></div>
    </div>

    <div class="container endpoint">
        <h2>üîß Servi√ßos</h2>
        <button onclick="getServices()">Listar Servi√ßos</button>
        <div id="services-result"></div>
    </div>

    <div class="container endpoint">
        <h2>üìß Emails</h2>
        <button onclick="getEmails()">Listar Emails</button>
        <div id="emails-result"></div>
    </div>

    <script>
        // Configura√ß√£o da API
        const API_BASE_URL = 'https://portal-services-api.onrender.com';
        
        // Fun√ß√£o para fazer requisi√ß√µes
        async function apiRequest(endpoint, options = {}) {
            const url = `${API_BASE_URL}${endpoint}`;
            const config = {
                headers: {
                    'Content-Type': 'application/json',
                    'Accept': 'application/json'
                },
                ...options
            };
            
            try {
                console.log(`üåê API Request: ${config.method || 'GET'} ${url}`);
                const response = await fetch(url, config);
                
                if (!response.ok) {
                    throw new Error(`HTTP error! status: ${response.status}`);
                }
                
                const data = await response.json();
                console.log(`‚úÖ API Response:`, data);
                return data;
            } catch (error) {
                console.error(`‚ùå API Error:`, error);
                throw error;
            }
        }

        // Fun√ß√£o para exibir resultado
        function displayResult(elementId, data, isError = false) {
            const element = document.getElementById(elementId);
            const className = isError ? 'error' : 'success';
            element.innerHTML = `<div class="${className}"><pre>${JSON.stringify(data, null, 2)}</pre></div>`;
        }

        // Fun√ß√£o para exibir loading
        function displayLoading(elementId) {
            const element = document.getElementById(elementId);
            element.innerHTML = '<div class="loading">üîÑ Carregando...</div>';
        }

        // Obter informa√ß√µes da API
        async function getApiInfo() {
            displayLoading('api-info-result');
            try {
                const data = await apiRequest('/api/info');
                displayResult('api-info-result', data);
            } catch (error) {
                displayResult('api-info-result', { error: error.message }, true);
            }
        }

        // Verificar sa√∫de da API
        async function checkApiHealth() {
            displayLoading('api-info-result');
            try {
                const data = await apiRequest('/health');
                displayResult('api-info-result', data);
            } catch (error) {
                displayResult('api-info-result', { error: error.message }, true);
            }
        }

        // Obter estat√≠sticas do neg√≥cio
        async function getBusinessStats() {
            displayLoading('stats-result');
            try {
                const data = await apiRequest('/api/stats/business');
                displayResult('stats-result', data);
            } catch (error) {
                displayResult('stats-result', { error: error.message }, true);
            }
        }

        // Obter estat√≠sticas do dashboard
        async function getDashboardStats() {
            displayLoading('stats-result');
            try {
                const data = await apiRequest('/api/stats/dashboard');
                displayResult('stats-result', data);
            } catch (error) {
                displayResult('stats-result', { error: error.message }, true);
            }
        }

        // Obter categorias
        async function getCategories() {
            displayLoading('categories-result');
            try {
                const data = await apiRequest('/api/categories');
                displayResult('categories-result', data);
            } catch (error) {
                displayResult('categories-result', { error: error.message }, true);
            }
        }

        // Criar categoria de exemplo
        async function createSampleCategory() {
            displayLoading('categories-result');
            try {
                const categoryData = {
                    name: `Categoria Teste ${Date.now()}`,
                    description: 'Categoria criada via exemplo frontend',
                    color: '#FF6B6B'
                };
                const data = await apiRequest('/api/categories', {
                    method: 'POST',
                    body: JSON.stringify(categoryData)
                });
                displayResult('categories-result', data);
            } catch (error) {
                displayResult('categories-result', { error: error.message }, true);
            }
        }

        // Obter clientes
        async function getClients() {
            displayLoading('clients-result');
            try {
                const data = await apiRequest('/api/clients');
                displayResult('clients-result', data);
            } catch (error) {
                displayResult('clients-result', { error: error.message }, true);
            }
        }

        // Criar cliente de exemplo
        async function createSampleClient() {
            displayLoading('clients-result');
            try {
                const clientData = {
                    name: `Cliente Teste ${Date.now()}`,
                    email: `cliente${Date.now()}@exemplo.com`,
                    phone: '(11) 99999-9999',
                    address: 'Rua de Exemplo, 123',
                    notes: 'Cliente criado via exemplo frontend'
                };
                const data = await apiRequest('/api/clients', {
                    method: 'POST',
                    body: JSON.stringify(clientData)
                });
                displayResult('clients-result', data);
            } catch (error) {
                displayResult('clients-result', { error: error.message }, true);
            }
        }

        // Obter servi√ßos
        async function getServices() {
            displayLoading('services-result');
            try {
                const data = await apiRequest('/api/services');
                displayResult('services-result', data);
            } catch (error) {
                displayResult('services-result', { error: error.message }, true);
            }
        }

        // Obter emails
        async function getEmails() {
            displayLoading('emails-result');
            try {
                const data = await apiRequest('/api/emails');
                displayResult('emails-result', data);
            } catch (error) {
                displayResult('emails-result', { error: error.message }, true);
            }
        }

        // Inicializar p√°gina
        window.onload = function() {
            console.log('üöÄ Portal Services API - Exemplo Frontend carregado');
            console.log('üåê API URL:', API_BASE_URL);
            
            // Verificar informa√ß√µes da API automaticamente
            getApiInfo();
        };
    </script>
</body>
</html>
